{"version":3,"file":"rpc-wrapper.js","sources":["../src/rpc-wrapper.js"],"sourcesContent":["export default function addMethods(worker, methods) {\n    let c = 0;\n    let callbacks = {};\n    worker.addEventListener('message', (e) => {\n        let d = e.data;\n        if (d.type!=='RPC') return;\n        if (d.id) {\n            let f = callbacks[d.id];\n            if (f) {\n                delete callbacks[d.id];\n                if (d.error) {\n                    let workerError = Error(d.error && d.error.message ? d.error.message : 'Error in worker');\n                    if (d.error && d.error.stack) workerError.stack = d.error.stack;\n                    if (d.error && d.error.name) workerError.name = d.error.name;\n                    f[1](workerError);\n                }\n                else f[0](d.result);\n            }\n        }\n        else {\n            let evt = document.createEvent('Event');\n            evt.initEvent(d.method, false, false);\n            evt.data = d.params;\n            worker.dispatchEvent(evt);\n        }\n    });\n    methods.forEach( method => {\n        worker[method] = (...params) => new Promise( (a, b) => {\n            let id = ++c;\n            callbacks[id] = [a, b];\n            worker.postMessage({ type: 'RPC', id, method, params });\n        });\n    });\n}\n"],"names":["let"],"mappings":"AAAe,SAAS,WAAW,MAAQ,EAAA,SAAS;IAChDA,IAAI,IAAI;IACRA,IAAI,YAAY;IAChB,MAAA,CAAO,gBAAP,CAAwB,qBAAY;QAChCA,IAAI,IAAI,CAAA,CAAE;QACV,IAAI,CAAA,CAAE,IAAF,KAAS;cAAO;QACpB,IAAI,CAAA,CAAE,IAAI;YACNA,IAAI,IAAI,SAAA,CAAU,CAAA,CAAE;YACpB,IAAI,GAAG;gBACH,OAAO,SAAA,CAAU,CAAA,CAAE;gBACnB,IAAI,CAAA,CAAE,OAAO;oBACTA,IAAI,cAAc,KAAA,CAAM,CAAA,CAAE,KAAF,IAAW,CAAA,CAAE,KAAF,CAAQ,OAAnB,GAA6B,CAAA,CAAE,KAAF,CAAQ,UAAU;oBACvE,IAAI,CAAA,CAAE,KAAF,IAAW,CAAA,CAAE,KAAF,CAAQ;0BAAO,WAAA,CAAY,KAAZ,GAAoB,CAAA,CAAE,KAAF,CAAQ;oBAC1D,IAAI,CAAA,CAAE,KAAF,IAAW,CAAA,CAAE,KAAF,CAAQ;0BAAM,WAAA,CAAY,IAAZ,GAAmB,CAAA,CAAE,KAAF,CAAQ;oBACxD,CAAA,CAAE,EAAF,CAAK;;sBAEJ,CAAA,CAAE,EAAF,CAAK,CAAA,CAAE;;eAGf;YACDA,IAAI,MAAM,QAAA,CAAS,WAAT,CAAqB;YAC/B,GAAA,CAAI,SAAJ,CAAc,CAAA,CAAE,QAAQ,OAAO;YAC/B,GAAA,CAAI,IAAJ,GAAW,CAAA,CAAE;YACb,MAAA,CAAO,aAAP,CAAqB;;;IAG7B,OAAA,CAAQ,OAAR,WAAiB;QACb,MAAA,CAAO,OAAP,gBAAiB;;;;mBAAe,IAAI,OAAJ,WAAc,CAAG,EAAA,GAAJ;YACzCA,IAAI,KAAK,EAAE;YACX,SAAA,CAAU,GAAV,GAAgB,CAAC,EAAG;YACpB,MAAA,CAAO,WAAP,CAAmB;gBAAE,MAAM,KAAR;oBAAe,EAAf;wBAAmB,MAAnB;wBAA2B;;;;;;;;;"}