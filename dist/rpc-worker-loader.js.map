{"version":3,"file":"rpc-worker-loader.js","sources":["../src/rpc-worker-loader.js"],"sourcesContent":["/* global __webpack_exports__ */\n\nfunction workerSetup() {\n    addEventListener('message', (e) => {\n        let { type, method, id, params } = e.data, f, p;\n        if (type==='RPC' && method) {\n            if ((f = __webpack_exports__[method])) {\n                p = Promise.resolve().then( () => f.apply(__webpack_exports__, params) );\n            }\n            else {\n                p = Promise.reject('No such method');\n            }\n            p.then(result => {\n                postMessage({ type: 'RPC', id, result });\n            })\n                .catch(error => {\n                    if (error.stack) {\n                        postMessage({ type: 'RPC', id, error: { name: error.name, message: error.message, stack: error.stack } });\n                        return;\n                    }\n                    postMessage({ type: 'RPC', id, error });\n                });\n        }\n    });\n    postMessage({ type: 'RPC', method: 'ready' });\n}\n\nconst workerScript = '\\n' + Function.prototype.toString.call(workerSetup).replace(/(^.*\\{|\\}.*$|\\n\\s*)/g, '');\n\nexport default function rpcWorkerLoader(content) {\n    return content + workerScript;\n}\n"],"names":["const"],"mappings":"AAEA,SAAS,cAAc;IACnB,gBAAA,CAAiB,qBAAY;QACzB,UAAmC,CAAA,CAAE;YAA/B;YAAM;YAAQ;YAAI;;QACxB,IAAI,IAAA,KAAO,KAAP,IAAgB,QAAQ;YACxB,IAAK,CAAA,GAAI,mBAAA,CAAoB,SAAU;gBACnC,CAAA,GAAI,OAAA,CAAQ,OAAR,EAAA,CAAkB,IAAlB,aAAwB,SAAM,CAAA,CAAE,KAAF,CAAQ,qBAAqB;mBAE9D;gBACD,CAAA,GAAI,OAAA,CAAQ,MAAR,CAAe;;YAEvB,CAAA,CAAE,IAAF,WAAO;gBACH,WAAA,CAAY;oBAAE,MAAM,KAAR;wBAAe,EAAf;4BAAmB;;cADnC,CAGK,KAHL,WAGW;gBACH,IAAI,KAAA,CAAM,OAAO;oBACb,WAAA,CAAY;wBAAE,MAAM,KAAR;4BAAe,EAAf;wBAAmB,OAAO;4BAAE,MAAM,KAAA,CAAM,IAAd;4BAAoB,SAAS,KAAA,CAAM,OAAnC;4BAA4C,OAAO,KAAA,CAAM;;;oBAC/F;;gBAEJ,WAAA,CAAY;oBAAE,MAAM,KAAR;wBAAe,EAAf;2BAAmB;;;;;IAI/C,WAAA,CAAY;QAAE,MAAM,KAAR;QAAe,QAAQ;;;;AAGvCA,IAAM,eAAe,IAAA,GAAO,QAAA,CAAS,SAAT,CAAmB,QAAnB,CAA4B,IAA5B,CAAiC,YAAjC,CAA8C,OAA9C,CAAsD,wBAAwB;AAE1G,AAAe,SAAS,gBAAgB,SAAS;IAC7C,OAAO,OAAA,GAAU;;;;;"}