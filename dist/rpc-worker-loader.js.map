{"version":3,"file":"rpc-worker-loader.js","sources":["../src/rpc-worker-loader.js"],"sourcesContent":["/* global __webpack_exports__ */\n\nfunction workerSetup() {\n\taddEventListener('message', (e) => {\n\t\tlet { type, method, id, params } = e.data, f, p;\n\t\tif (type==='RPC' && method) {\n\t\t\tif ((f = __webpack_exports__[method])) {\n\t\t\t\tp = Promise.resolve().then( () => f.apply(__webpack_exports__, params) );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tp = Promise.reject('No such method');\n\t\t\t}\n\t\t\tp.then(result => {\n\t\t\t\t\tpostMessage({ type: 'RPC', id, result });\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tif (error.stack) {\n\t\t\t\t\t\tpostMessage({ type: 'RPC', id, error: { name: error.name, message: error.message, stack: error.stack } });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tpostMessage({ type: 'RPC', id, error });\n\t\t\t\t});\n\t\t}\n\t});\n\tpostMessage({ type: 'RPC', method: 'ready' });\n}\n\nconst workerScript = '\\n' + Function.prototype.toString.call(workerSetup).replace(/(^.*\\{|\\}.*$|\\n\\s*)/g, '');\n\nexport default function rpcWorkerLoader(content) {\n\treturn content + workerScript;\n}\n"],"names":["const"],"mappings":"AAEA,SAAS,cAAc;IACtB,gBAAA,CAAiB,qBAAY;QAC5B,UAAmC,CAAA,CAAE;YAA/B;YAAM;YAAQ;YAAI;;QACxB,IAAI,IAAA,KAAO,KAAP,IAAgB,QAAQ;YAC3B,IAAK,CAAA,GAAI,mBAAA,CAAoB,SAAU;gBACtC,CAAA,GAAI,OAAA,CAAQ,OAAR,EAAA,CAAkB,IAAlB,aAAwB,SAAM,CAAA,CAAE,KAAF,CAAQ,qBAAqB;mBAE3D;gBACJ,CAAA,GAAI,OAAA,CAAQ,MAAR,CAAe;;YAEpB,CAAA,CAAE,IAAF,WAAO;gBACL,WAAA,CAAY;oBAAE,MAAM,KAAR;wBAAe,EAAf;4BAAmB;;cADjC,CAGE,KAHF,WAGQ;gBACN,IAAI,KAAA,CAAM,OAAO;oBAChB,WAAA,CAAY;wBAAE,MAAM,KAAR;4BAAe,EAAf;wBAAmB,OAAO;4BAAE,MAAM,KAAA,CAAM,IAAd;4BAAoB,SAAS,KAAA,CAAM,OAAnC;4BAA4C,OAAO,KAAA,CAAM;;;oBAC/F;;gBAED,WAAA,CAAY;oBAAE,MAAM,KAAR;wBAAe,EAAf;2BAAmB;;;;;IAInC,WAAA,CAAY;QAAE,MAAM,KAAR;QAAe,QAAQ;;;;AAGpCA,IAAM,eAAe,IAAA,GAAO,QAAA,CAAS,SAAT,CAAmB,QAAnB,CAA4B,IAA5B,CAAiC,YAAjC,CAA8C,OAA9C,CAAsD,wBAAwB;AAE1G,AAAe,SAAS,gBAAgB,SAAS;IAChD,OAAO,OAAA,GAAU;;;;;"}